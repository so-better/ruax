!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Ruax={})}(this,(function(e){"use strict";var t=Object.defineProperty,s=(e,s,r)=>((e,s,r)=>s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[s]=r)(e,"symbol"!=typeof s?s+"":s,r);const r={matchingText:(e,t)=>"Chinese"==t?/^[\u4e00-\u9fa5]+$/.test(e):"chinese"==t?/[\u4e00-\u9fa5]/.test(e):"email"==t?/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/.test(e):"username"==t?/^[a-zA-Z0-9_]{4,16}$/.test(e):"int+"==t?/^\d+$/.test(e):"int-"==t?/^-\d+$/.test(e):"int"==t?/^-?\d+$/.test(e):"pos"==t?/^\d*\.?\d+$/.test(e):"neg"==t?/^-\d*\.?\d+$/.test(e):"number"==t?/^-?\d*\.?\d+$/.test(e):"phone"==t?/^1[0-9]\d{9}$/.test(e):"idCard"==t?/^[1-9]\d{5}(18|19|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/.test(e):"url"==t?/^(https?|ftp):\/\/(-\.)?([^\s\/?\.#-]+\.?)+(\/[^\s]*)?$/.test(e):"IPv4"==t?/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e):"hex"==t?/^#([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/.test(e):"rgb"==t?/^rgb\((25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d),\s?(25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d),\s?(25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\)$/.test(e):"rgba"==t?/^rgba\((25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d),\s?(25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d),\s?(25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d),\s?(0?\.\d|1(\.0)?|0)\)$/.test(e):"QQ"==t?/^[1-9][0-9]{4,10}$/.test(e):"weixin"==t?/^[a-zA-Z]([-_a-zA-Z0-9]{5,19})+$/.test(e):"plate"==t&&/^[京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼]{1}[A-Z]{1}[A-Z0-9]{4}[A-Z0-9挂学警港澳]{1}$|^[京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼]{1}[D|F]{1}[A-Z0-9]{5,6}$/.test(e),getUrlParams(e){const t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)");let s=window.location.search.substring(1);if(!s){const e=window.location.hash.split("?");2==e.length&&(s=e[1])}let r=s.match(t);if(r)return decodeURIComponent(r[2])},isEmptyObject(e){return this.isObject(e)&&0==Object.keys(e).length},equal(e,t){if(typeof e!=typeof t)return!1;if(this.isObject(e)&&this.isObject(t)){const s=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(t);if(s.length!=r.length)return!1;const o=s.length;let n=!0;for(let i=0;i<o;i++){const r=s[i],o=e[r],a=t[r];if(!this.equal(o,a)){n=!1;break}}return n}return e===t},isObject:e=>"object"==typeof e&&!!e,copyText(e){if(!navigator.clipboard)throw new Error("navigator.clipboard must be obtained in a secure environment, such as localhost, 127.0.0.1, or https, so the method won't work");return navigator.clipboard.writeText(e)},clone(e){if(this.isObject(e)){if(Array.isArray(e))return e.map((e=>this.clone(e)));const t={};for(let s in e)t[s]=this.clone(e[s]);return t}return e}};class o{constructor(){s(this,"baseUrl",""),s(this,"method","GET"),s(this,"headers",{}),s(this,"responseType","json"),s(this,"timeout",3e3),s(this,"mode","cors"),s(this,"cache","default"),s(this,"beforeRequest"),s(this,"beforeResponse"),s(this,"cancelRequest"),s(this,"onProgress")}async create(e){if(!window.fetch)throw new Error("The current browser does not support the Fetch API.");const{beforeRequest:t=this.beforeRequest,beforeResponse:s=this.beforeResponse}=e;let r=this.deleteProperty(e,["beforeRequest","beforeResponse"]);t&&(r=t.apply(this,[r]));const{baseUrl:o=this.baseUrl,url:n,method:i=this.method,headers:a,responseType:c=this.responseType,body:d,timeout:h=this.timeout,mode:l=this.mode,cache:u=this.cache,cancelRequest:f=this.cancelRequest,onProgress:p=this.onProgress}=r;let b=await this.fetchWrapper({timeout:h,cancelRequest:f,input:`${o}${n}`,init:{method:i.toLocaleUpperCase(),headers:{...this.headers,...a},mode:l,cache:u,body:d}});if(!b.ok){if(s)return s.apply(this,[b,r,null]);throw new Error(`The fetch request failed, status code: ${b.status}, exception information: ${b.statusText}`)}if(p&&(b=this.readProgress(b,p)),"json"==c){const e=await b.json();return s?s.apply(this,[b,r,e]):e}if("blob"==c){const e=await b.blob();return s?s.apply(this,[b,r,e]):e}if("text"==c){const e=await b.text();return s?s.apply(this,[b,r,e]):e}if("formData"==c){const e=await b.formData();return s?s.apply(this,[b,r,e]):e}if("arrayBuffer"==c){const e=await b.arrayBuffer();return s?s.apply(this,[b,r,e]):e}}async post(e,t){return this.create({method:"POST",url:e,body:t})}async get(e){return this.create({method:"GET",url:e})}deleteProperty(e,t){const s=r.clone(e);return t.forEach((e=>{delete s[e]})),s}fetchWrapper(e){const{timeout:t=this.timeout,cancelRequest:s,init:r,input:o}=e,n=new Error(`The fetch request failed because time exceeded ${t}ms`),i=new Error("The fetch request was actively canceled"),a=new AbortController,c=setTimeout((()=>{a.abort(n)}),t);return s&&s.apply(this,[a.abort.bind(a,i)]),window.fetch(o,{...r,signal:a.signal}).finally((()=>clearTimeout(c)))}readProgress(e,t){const s=e.headers.get("Content-Length");if(!s||!e.body)return e;let r=0;const o=parseInt(s,10),n=e.body.getReader(),i=new ReadableStream({async start(e){for(;;){const{done:s,value:i}=await n.read();if(s){e.close();break}r+=i.length;const a=r/o*100;null==t||t.apply(this,[a]),e.enqueue(i)}}});return new Response(i)}}e.Ruax=o,e.default=o,Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
